
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="The documentation for the PyMSM software library.">
      
      
        <meta name="author" content="Hagai Rossman, Ayya Keshet">
      
      
      <link rel="icon" href="../pymsm_icon.svg">
      <meta name="generator" content="mkdocs-1.3.0, mkdocs-material-8.2.8">
    
    
      
        <title>Methods - PyMSM</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.644de097.min.css">
      
        
        <link rel="stylesheet" href="../assets/stylesheets/palette.e6a45f82.min.css">
        
      
    
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../assets/_mkdocstrings.css">
    
      <link rel="stylesheet" href="../css/ansi-colours.css">
    
      <link rel="stylesheet" href="../css/jupyter-cells.css">
    
      <link rel="stylesheet" href="../css/pandas-dataframe.css">
    
    <script>__md_scope=new URL("..",location),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      
  


  
  


  <script>function gtag(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","G-4PXS01G51T"),document.addEventListener("DOMContentLoaded",function(){document.forms.search&&document.forms.search.query.addEventListener("blur",function(){this.value&&gtag("event","search",{search_term:this.value})}),"undefined"!=typeof location$&&location$.subscribe(function(e){gtag("config","G-4PXS01G51T",{page_path:e.pathname})})})</script>
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-4PXS01G51T"></script>


    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="white" data-md-color-accent="amber">
  
    
    
      <script>var palette=__md_get("__palette");if(palette&&"object"==typeof palette.color)for(var key of Object.keys(palette.color))document.body.setAttribute("data-md-color-"+key,palette.color[key])</script>
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#methods" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href=".." title="PyMSM" class="md-header__button md-logo" aria-label="PyMSM" data-md-component="logo">
      
  <img src="../pymsm_icon.svg" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            PyMSM
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Methods
            
          </span>
        </div>
      </div>
    </div>
    
      <form class="md-header__option" data-md-component="palette">
        
          
          
          <input class="md-option" data-md-color-media="" data-md-color-scheme="default" data-md-color-primary="white" data-md-color-accent="amber"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_1">
          
            <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_2" hidden>
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m17.75 4.09-2.53 1.94.91 3.06-2.63-1.81-2.63 1.81.91-3.06-2.53-1.94L12.44 4l1.06-3 1.06 3 3.19.09m3.5 6.91-1.64 1.25.59 1.98-1.7-1.17-1.7 1.17.59-1.98L15.75 11l2.06-.05L18.5 9l.69 1.95 2.06.05m-2.28 4.95c.83-.08 1.72 1.1 1.19 1.85-.32.45-.66.87-1.08 1.27C15.17 23 8.84 23 4.94 19.07c-3.91-3.9-3.91-10.24 0-14.14.4-.4.82-.76 1.27-1.08.75-.53 1.93.36 1.85 1.19-.27 2.86.69 5.83 2.89 8.02a9.96 9.96 0 0 0 8.02 2.89m-1.64 2.02a12.08 12.08 0 0 1-7.8-3.47c-2.17-2.19-3.33-5-3.49-7.82-2.81 3.14-2.7 7.96.31 10.98 3.02 3.01 7.84 3.12 10.98.31z"/></svg>
            </label>
          
        
          
          
          <input class="md-option" data-md-color-media="" data-md-color-scheme="slate" data-md-color-primary="black" data-md-color-accent="amber"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_2">
          
            <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_1" hidden>
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 7a5 5 0 0 1 5 5 5 5 0 0 1-5 5 5 5 0 0 1-5-5 5 5 0 0 1 5-5m0 2a3 3 0 0 0-3 3 3 3 0 0 0 3 3 3 3 0 0 0 3-3 3 3 0 0 0-3-3m0-7 2.39 3.42C13.65 5.15 12.84 5 12 5c-.84 0-1.65.15-2.39.42L12 2M3.34 7l4.16-.35A7.2 7.2 0 0 0 5.94 8.5c-.44.74-.69 1.5-.83 2.29L3.34 7m.02 10 1.76-3.77a7.131 7.131 0 0 0 2.38 4.14L3.36 17M20.65 7l-1.77 3.79a7.023 7.023 0 0 0-2.38-4.15l4.15.36m-.01 10-4.14.36c.59-.51 1.12-1.14 1.54-1.86.42-.73.69-1.5.83-2.29L20.64 17M12 22l-2.41-3.44c.74.27 1.55.44 2.41.44.82 0 1.63-.17 2.37-.44L12 22z"/></svg>
            </label>
          
        
      </form>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" aria-label="Clear" tabindex="-1">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/hrossman/pymsm/" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.1.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>
  </div>
  <div class="md-source__repository">
    hrossman/pymsm
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="PyMSM" class="md-nav__button md-logo" aria-label="PyMSM" data-md-component="logo">
      
  <img src="../pymsm_icon.svg" alt="logo">

    </a>
    PyMSM
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/hrossman/pymsm/" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.1.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>
  </div>
  <div class="md-source__repository">
    hrossman/pymsm
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href=".." class="md-nav__link">
        PyMSM in a nutshell
      </a>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_2" type="checkbox" id="__nav_2" >
      
      
      
      
        <label class="md-nav__link" for="__nav_2">
          Usage
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Usage" data-md-level="1">
        <label class="md-nav__title" for="__nav_2">
          <span class="md-nav__icon md-icon"></span>
          Usage
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../usage/Preparing_a_dataset/" class="md-nav__link">
        Preparing a dataset
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../usage/fitting_a_multistate_model/" class="md-nav__link">
        Fitting a multistate model
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../usage/path_sampling/" class="md-nav__link">
        Path sampling
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../usage/Datasets/" class="md-nav__link">
        Datasets
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../usage/competing_risks_stackplot/" class="md-nav__link">
        Competing risks stackplot
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../usage/examining_a_model/" class="md-nav__link">
        Examining a model
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../usage/custom_fitters/" class="md-nav__link">
        Custom fitters
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../usage/Simulator/" class="md-nav__link">
        Simulator
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_3" type="checkbox" id="__nav_3" >
      
      
      
      
        <label class="md-nav__link" for="__nav_3">
          Full examples
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Full examples" data-md-level="1">
        <label class="md-nav__title" for="__nav_3">
          <span class="md-nav__icon md-icon"></span>
          Full examples
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../full_examples/Rotterdam_example/" class="md-nav__link">
        Rotterdam example
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../full_examples/COVID_hospitalization_example/" class="md-nav__link">
        COVID hospitalization example
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../full_examples/AIDSI_example/" class="md-nav__link">
        AIDSI example
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../full_examples/EBMT_example/" class="md-nav__link">
        EBMT example
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4" type="checkbox" id="__nav_4" >
      
      
      
      
        <label class="md-nav__link" for="__nav_4">
          API
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="API" data-md-level="1">
        <label class="md-nav__title" for="__nav_4">
          <span class="md-nav__icon md-icon"></span>
          API
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../api/multistate_model/" class="md-nav__link">
        Multistate model
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../api/multistate_simulator/" class="md-nav__link">
        Multistate simulator
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../api/pathobject/" class="md-nav__link">
        Pathobject
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#introduction" class="md-nav__link">
    Introduction
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#estimation" class="md-nav__link">
    Estimation
  </a>
  
    <nav class="md-nav" aria-label="Estimation">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#cox-transition-specific-hazard-models" class="md-nav__link">
    Cox transition-specific hazard models
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#other-transition-specific-models" class="md-nav__link">
    Other transition-specific models
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#prediction-monte-carlo-simulation" class="md-nav__link">
    Prediction - Monte Carlo Simulation
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#generating-random-multistate-survival-data" class="md-nav__link">
    Generating Random Multistate Survival Data
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content" data-md-component="content">
            <article class="md-content__inner md-typeset">
              
                


<h1 id="methods">Methods<a class="headerlink" href="#methods" title="Permanent link">¤</a></h1>
<div class="admonition warning">
<p class="admonition-title">Under Construction</p>
</div>
<p>In this section we give an overview of the models and methods underlying the statistics and computations performed in <code>PyMSM</code>.  </p>
<h2 id="introduction">Introduction<a class="headerlink" href="#introduction" title="Permanent link">¤</a></h2>
<p><code>PyMSM</code> fits and predicts based on a multistate model supplied by the user. <br />
Some examples of multistate models:  </p>
<p>1) A simple competing-risk form with three states, <span class="arithmatex">\(A,B,C\)</span> and two possible transitions, <span class="arithmatex">\(A \rightarrow B\)</span> and <span class="arithmatex">\(A \rightarrow C\)</span> .  </p>
<pre class="mermaid"><code>stateDiagram-v2
    A --&gt; B
    A --&gt; C</code></pre>
<p>2) An illness-death model with the same three states but three possible transitions <span class="arithmatex">\(A \rightarrow B\)</span>, <span class="arithmatex">\(A \rightarrow C\)</span> and <span class="arithmatex">\(B \rightarrow C\)</span> . </p>
<pre class="mermaid"><code>stateDiagram-v2
    A --&gt; B
    A --&gt; C
    B --&gt; C</code></pre>
<p>3) Or any other more involved multistate framework (add figures of these models). </p>
<p>The description of the content of <code>PyMSM</code> would be easier to digest under a certain setting.  Thus, to set the stage, we adopt the multistate model of <a href="https://academic.oup.com/jamia/article/28/6/1188/6105188">Roimi et. al. (2021)</a>. Specifically, assume a multi-state model consists of four states <span class="arithmatex">\(A,B,C,D\)</span> and six possible transitions:
$$
A \rightarrow B \,\,\,\,\,\,       A \rightarrow C   \,\,\,\,\,\,     A \rightarrow D   \,\,\,\,\,\,    B \rightarrow A \,\,\,\,\,\,    B \rightarrow D \,\,\,\,\,\,   C \rightarrow A \, .
$$</p>
<p><pre class="mermaid"><code>stateDiagram-v2
    A --&gt; B
    A --&gt; C
    A --&gt; D
    B --&gt; A
    B --&gt; D
    C --&gt; A</code></pre>
Each transition is characterizes by a transition-specific hazard function, also known as a cause-specific hazard function,
$$
\lambda_{A,B} (t|Z) \,\,\, \lambda_{A,C} (t|Z) \,\,\,   \lambda_{A,D} (t|Z) \,\,\, \lambda_{B,A} (t|Z)  \,\,\, \lambda_{B,D} (t|Z) \,\,\,  \lambda_{C,A} (t|Z) \,
$$
for <span class="arithmatex">\(t &gt; 0\)</span> and <span class="arithmatex">\(Z\)</span> vector of covariates. Although <span class="arithmatex">\(Z\)</span> is shared by the six models above,  it does not imply that identical covariates must be used in these models. For example, in Cox models with   transition-dependent   regression coefficient vectors,  one can set any specific coefficient to 0 for excluding  the corresponding covariate.  </p>
<p>Let <span class="arithmatex">\(J_C\)</span> and <span class="arithmatex">\(J_N\)</span> denote the current and next states, respectively, and <span class="arithmatex">\(T\)</span> denotes the transition time. Assume the journey of an observation in the system described by the multi-state model starts at state <span class="arithmatex">\(j^*\)</span> with vector of baseline covariates <span class="arithmatex">\(W\)</span>. Let <span class="arithmatex">\(Z(t)\)</span> be a time-dependent vector of covariates, where
$$ 
Z(t) = (W^T,\widetilde{W}(t))
$$
and <span class="arithmatex">\(\widetilde{W}(t)\)</span> is a time-dependent vector of covariates known at the entrance to the new state. Let <span class="arithmatex">\(K_{j^*}\)</span> be the set of possible states that can be reached directly from state <span class="arithmatex">\(j^*\)</span>. Then, the conditional probability of transition <span class="arithmatex">\(j^* \rightarrow j\)</span>, <span class="arithmatex">\(j \in K_{j^*}\)</span>, by time <span class="arithmatex">\(t\)</span> given <span class="arithmatex">\(Z(0)=Z\)</span> is given by
$$
\Pr(T \leq t, J_N=j|J_C=j^<em>,Z(0)=Z) = \int_0^t \lambda_{j^</em>,j}(u|Z)\exp\left{-\sum_{k=1}^{|K_{j^<em>}|} \Lambda_{j^</em>,k}(u-|Z) \right} du \, ,
$$
where <span class="arithmatex">\(u-\)</span> is a time  just prior to <span class="arithmatex">\(u\)</span>, <span class="arithmatex">\(|K_{j^*}|\)</span> is the cardinality of <span class="arithmatex">\(K_{j^*}\)</span> and  <span class="arithmatex">\(\Lambda_{j,k}(t|Z)=\int_0^t \lambda_{j,k}(u|Z) du\)</span> is the cumulative hazard function. In our example, if the first state <span class="arithmatex">\(j^*=A\)</span>, <span class="arithmatex">\(K_{j^*}=\{B,C,D\}\)</span>, and </p>
<div class="arithmatex">\[
\Pr(T \leq t, J_N=j|J_C=A,Z(0)=Z) = 
$$  
$$
\int_0^t \lambda_{A,j}(u|Z)\exp\left\{- \Lambda_{A,B}(u-|Z) - \Lambda_{A,C}(u-|Z) - \Lambda_{A,D}(u-|Z)\right\} du \, ,
\]</div>
<p>The marginal probability of transition <span class="arithmatex">\(j^* \rightarrow j\)</span> is given by
$$
\Pr(J_N=j|J_C=j^<em>,Z(0)=Z) = \int_0^\infty \lambda_{j^</em>,j}(u|Z)\exp\left{-\sum_{k=1}^{|K_{j^<em>}|} \Lambda_{j^</em>,k}(u-|Z) \right} du \, ,
$$
and the probability of transition time less than <span class="arithmatex">\(t\)</span> given a transition <span class="arithmatex">\(j^* \rightarrow j\)</span>
$$
\Pr(T \leq t | J_N=j,J_C=j^<em>, Z(0)=Z)
= \frac{ \int_0^t \lambda_{j^</em>,j}(u|Z)\exp\left{-\sum_{k=1}^{|K_{j^<em>}|} \Lambda_{j^</em>,k}(u-|Z) \right} du  }
{ \int_0^\infty \lambda_{j^<em>,j}(u|Z)\exp\left{-\sum_{k=1}^{|K_{j^</em>}|} \Lambda_{j^*,k}(u-|Z) \right} du  }  \, .
$$
Now assume an observation entered state <span class="arithmatex">\(j'\)</span> at time <span class="arithmatex">\(t'&gt;0\)</span> with <span class="arithmatex">\(Z(t')\)</span>. Then, the probability of <span class="arithmatex">\(j' \rightarrow j\)</span> by time <span class="arithmatex">\(t\)</span> is given by 
$$
\Pr(T \leq t, J_N=j|J_C=j',Z(t')=Z) = \int_{t'}^t \lambda_{j',j}(u|Z)\exp\left{-\sum_{k=1}^{|K_{j'}|} \Lambda_{j',k}(u-|Z) \right} du \, ,
$$
and
$$
\Pr(T \leq t| J_N=j,J_C=j',Z(t')=Z) = 
\frac{ \int_{t'}^t \lambda_{j',j}(u|Z)\exp\left{-\sum_{k=1}^{|K_{j'}|} \Lambda_{j',k}(u-|Z) \right} du }
{ \int_{t'}^\infty \lambda_{j',j}(u|Z)\exp\left{-\sum_{k=1}^{|K_{j'}|} \Lambda_{j',k}(u-|Z) \right} du } \, .
$$  <br />
All the above, set the main multi-state model components required for prediction, as will be explained in the following sections.</p>
<h2 id="estimation">Estimation<a class="headerlink" href="#estimation" title="Permanent link">¤</a></h2>
<h3 id="cox-transition-specific-hazard-models">Cox transition-specific hazard models<a class="headerlink" href="#cox-transition-specific-hazard-models" title="Permanent link">¤</a></h3>
<p>The estimation procedure for the hazard functions that define the multi-state model can be chosen by the user. For example, if Cox models are adopted, where each transition <span class="arithmatex">\(j \rightarrow j'\)</span> consists of transition-specific unspecified baseline hazard function <span class="arithmatex">\(\lambda_{0j,j'}(\cdot)\)</span> and a 
transition-specific vector of regression coefficients <span class="arithmatex">\(\beta_{j,j'}\)</span>, i.e.,
$$
\lambda_{j,j'}(t|Z) = \lambda_{0j,j'}(t) \exp(Z^T \beta_{j,j'}) \, ,
$$
the estimation procedure is straightforward. Specifically, under transition-specific semi-parametric Cox models, we can easily deal with: 
- Right censoring and competing events based on the approach of [@Andersen:1991]. Namely, maximization of the likelihood function in terms of all the involved  Cox models is done by maximizing the likelihood of each transition separately. Thus, we use the standard partial likelihood estimators of <span class="arithmatex">\(\beta_{j,j'}\)</span> [@Klein:2006] and Breslow estimator of <span class="arithmatex">\(\Lambda_{0j,j'}(t)=\int_0^t \lambda_{0j,j'}(u)du\)</span> (Breslow, 1972). 
- Left truncation which occurs at each transition that is not the origin state of the subject's path. Bias due to left truncation is eliminated by using the well-known risk-set correction [@Klein:2006]. 
- Recurrent events which occurs when subjects visit the same state multiple times. In such cases, the robust standard errors account for correlated outcomes within a subject [@Andersen:1982].     </p>
<p>Based on the estimates of the regression coefficients and the cumulative baseline hazard functions all the distribution functions in the introduction section can be estimated by replacing the integrals with sums over the observed failure time, and any unknown parameter is replaced by its estimator. Specifically, let <span class="arithmatex">\(\tau_{j^*,j}\)</span> be the largest observed event time of transition <span class="arithmatex">\(j^* \rightarrow j\)</span>. Then, 
\begin{equation}
    \begin{aligned}
\widehat{\Pr} (J_N=j | J_C=j^<em>,Z(0)=Z) \
    =   \sum_{t_m \leq \tau_{j^</em>,j}} \exp\left( \widehat\beta_{j^<em>,j}^T Z\right) \widehat\lambda_{0j^</em>,j}(t_m) \exp \left{-\sum_{k=1}^{|K_{j^<em>}|} \widehat\Lambda_{0j^</em>,k}(t_{m-1})\exp\left( \widehat\beta_{j^*,k}^T Z\right) \right} \, ,<br />
    \end{aligned}
\end{equation}</p>
<div class="arithmatex">\[\begin{equation}
    \begin{aligned}
\widehat{\Pr} (T\leq t| J_N=j', J_C=j^* , Z(0)=Z)\\
    \hspace{0.5cm} = \frac{\sum_{t_m \leq t} \exp\left( \widehat\beta_{j^*,j'}^T Z\right) \widehat\lambda_{0j^*,j'}(t_m) \exp \left\{-\sum_{k=1}^{|K_{j^*}|} \widehat\Lambda_{0j^*,k}(t_{m-1})\exp\left( \widehat\beta_{j^*k}^T Z\right) \right\} }{ \sum_{t_m \leq \tau_{j^*,j'}} \exp\left( \widehat\beta_{j^*,j'}^T Z\right) \widehat\lambda_{0j^*,j'}(t_m) \exp \left\{-\sum_{k=1}^{K_{j^*}} \widehat\Lambda_{0j^*,k}(t_{m-1})\exp\left( \widehat\beta_{j^*,k}^T Z\right) \right\} } \, , 
    \end{aligned}
\end{equation}
and finally, given a new $\breve{j}$, the estimated probability of staying at state $j'$ less than or equal $t$ time unit is given by
\begin{equation}
    \begin{aligned}
\widehat{\Pr} (T\leq t| J_N=\breve{j}, J_C=j' , Z(t')=Z) \\
    \hspace{0.5cm} = \frac{\sum_{t' &lt; t_m \leq t} \exp\left( \widehat\beta_{j',\breve{j}}^T Z\right) \widehat\lambda_{0j',\breve{j}}(t_m) \exp \left\{-\sum_{k=1}^{|K_{j'}|} \widehat\Lambda_{0j',k}(t_{m-1})\exp\left( \widehat\beta_{j',k}^T Z\right) \right\} }{ \sum_{t' &lt; t_m \leq \tau_{j',\breve{j}}} \exp\left( \widehat\beta_{j',\breve{j}}^T Z\right) \widehat\lambda_{0j',\breve{j}}(t_m) \exp \left\{-\sum_{k=1}^{K_{j'}} \widehat\Lambda_{0j',k}(t_{m-1})\exp\left( \widehat\beta_{j',k}^T Z\right) \right\} } \, .
    \end{aligned}
\end{equation}\]</div>
<h3 id="other-transition-specific-models">Other transition-specific models<a class="headerlink" href="#other-transition-specific-models" title="Permanent link">¤</a></h3>
<p>Similarly, the user can define other survival models and estimation procedure, such as accelerated failure time model, random survival forests (ref) etc, for each transition, as explained in section Costume Fitters above.</p>
<h2 id="prediction-monte-carlo-simulation">Prediction - Monte Carlo Simulation<a class="headerlink" href="#prediction-monte-carlo-simulation" title="Permanent link">¤</a></h2>
<p>Based on the multi-state model, we reconstruct the complete distribution of the path for a new observation, given the observed covariates <span class="arithmatex">\(W\)</span>. Based on the reconstructed distribution we estimate
- The probability of visiting each state.
- The total length of stay at each state.
- The total length of stay in the entire system.</p>
<p>The above quantities can be predicted before entering the system and also during the stay at one of the systems' states, while correctly taking into account the accumulated time already spent in the system and <span class="arithmatex">\(Z(\cdot)\)</span>.</p>
<p>We reconstruct the distribution of the path for a new observation by Monte-Carlo simulation. Assume the starting state (provided by the user) is <span class="arithmatex">\(j^*\)</span>. Then, the next state <span class="arithmatex">\(J_N\)</span> is sampled based on the discrete conditional probabilities
$$
p_{j|j^<em>,Z}= \frac{\widehat{\Pr} (J_N=j | J_C=j^</em>, Z(0)=Z) }{\sum_{j'=1}^{K_{j^<em>}} \widehat{\Pr} (J_N=j' | J_C=j^</em>, Z(0)=Z)}  \, .
$$
where <span class="arithmatex">\(j \in K_{j^*}\)</span> and the summation is over the distinct observed event times of transition <span class="arithmatex">\(j^* \rightarrow j\)</span>. Once we sampled the next state, denoted by <span class="arithmatex">\(j'\)</span>, the time to be spent at state <span class="arithmatex">\(j^*\)</span> is sampled based on 
$$
\widehat{\Pr} (T\leq t| J_N=j', J_C=j^<em> , Z(0)=Z) \, .
$$
This is done by sampling <span class="arithmatex">\(U \sim Uniform[0,1]\)</span>, equating 
$$
U=\widehat{\Pr} (T\leq t| J_N=j', J_C=j^</em> , Z(0)=Z)
$$ 
and solving for <span class="arithmatex">\(t\)</span>. Denote the sampled time by <span class="arithmatex">\(t'\)</span> and update <span class="arithmatex">\(Z(t')\)</span>. In case <span class="arithmatex">\(j'\)</span>, is a terminal state, the sampling path ends here. Otherwise, the current state is updated to <span class="arithmatex">\(J_C=j'\)</span>, and the following state is sampled by <span class="arithmatex">\(p_{j|j',Z(t')}\)</span>, <span class="arithmatex">\(j=1 \in  K_{j'}\)</span>, 
$$
p_{<code>j|j',Z}= \frac{\sum_{t' &lt; t_m \leq \tau_{j',j}} \exp\left( \widehat\beta_{j',j}^T Z\right) \widehat\lambda_{0j',j}(t_m) \exp \left\{-\sum_{k=1}^{|K_{j'}|} \widehat\Lambda_{0j',k}(t_{m-1})\exp\left( \widehat\beta_{j',k}^T Z\right) \right\} }
    {\sum_{j^{**}=1}^{K_{j'}} \sum_{t' &lt; t_m \leq \tau_{j',j^{**}}} \exp\left( \widehat\beta_{j',j^{**}}^T Z\right) \widehat\lambda_{0j',j^{**}}(t_m) \exp \left\{-\sum_{k=1}^{|K_{j'}|} \widehat\Lambda_{0j',k}(t_{m-1})\exp\left( \widehat\beta_{j',k}^T Z\right) \right\}} \, .</code>
$$</p>
<h2 id="generating-random-multistate-survival-data">Generating Random Multistate Survival Data<a class="headerlink" href="#generating-random-multistate-survival-data" title="Permanent link">¤</a></h2>
<p><code>PyMSM</code> allows the user to predefine a model by providing an input of transition-specific baseline hazards and hazard coefficients <span class="arithmatex">\(\beta_{j,j'}\)</span>, and a time-varying covariates update function if needed. After providing this information, the user can then simulate trajectories, thus creating a new multi-state data-set which may be valuable for a variety of purposes.</p>
<div class="arithmatex">\[
\Pr(T \leq t, J_N=j|J_C=j^*,Z(0)=Z) = \int_0^t \lambda_{j^*,j}(u|Z)\exp\left\{-\sum_{k=1}^{|K_{j^*}|} \Lambda_{j^*,k}(u-|Z) \right\}du
\]</div>

              
            </article>
          </div>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    <script id="__config" type="application/json">{"base": "..", "features": [], "search": "../assets/javascripts/workers/search.5e67fbfe.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version.title": "Select version"}}</script>
    
    
      <script src="../assets/javascripts/bundle.c44cc438.min.js"></script>
      
        <script src="../javascripts/mathjax.js"></script>
      
        <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
      
        <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
      
    
  </body>
</html>